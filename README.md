Shared in this repository are the scripts I have used to create a Perforce style file lockout system for my team working in Unreal Engine. While it can't actually prevent users from editing a locked file, it will quickly ping them as soon as changes are saved to a file locked by another user. Here's what you can do to get this system working for your team.

Step 1: Set up a google sheet to store your file statuses. The layout I chose was: column for file name, column for locked status (options are Yes or No), column for the name of the user who holds the lock. If you choose to use a different layout, be aware that you will need to edit the code across the system to accomodate your changes.

Step 2: Once you have your sheet set up, open Google Apps Script and create a new project associated with your sheet. In the editor, paste the code from the code.gs file in the Lockout Sheet Script folder.

Step 3: Generate a GitHub API personal access token following the instructions here: https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens. Plug this token in for the AUTH_TOKEN variable in the script.

Step 4: Fill in the other information omitted in the script. You'll need a share link to your spreadsheet and an api link to your repository.

Step 5: Set up a trigger for this script to execute as often as you'd like.

Step 6. You'll now need a Google Cloud account to obtain API access for the other scripts and set your bot up to run continuously. On APIs and Services, you will need to generate an API key for sheets and a service account. With your service account's options open, add a key and choose to download it as a .json file.

Step 7: Create your bot as an application using the Discord Developer Portal. Here, you can also get the authorization codes that you will need for your bot to access Discord. Now you should be able to fill in all the ommitted info in the lockoutBot.py script. As posted here, the script is set up to pull those variables from a .env file located in the same folder. You will need to store the values there unless you change this. To get the values for GUILD_ID, BOT_CHANNEL, and WEBHOOK_CHANNEL, enable Developer Mode on Discord and copy the IDs for the Discord server your bot will run on, the channel you want your lockout list posted to, and the channel where the webhook will be posting to notify the bot.

Step 8: The bot should now be ready to deploy. From the OAuth2 tab on the Discord Developer Portal, select all the permissions your bot will need and generate an invite link to add it to your server. For "Scopes", select "bot", and for permissions, make sure it has "Send Messages", "Manage Messages", and "Read Message History". I don't recall if any of the other scopes were necessary for this bot to work, but now would be a good time to test anyway and verify that the bot functions. You should be able to run the python script on your machine and activate the bot at this point, provided you have all of the imported packages installed to python. If any of features do not appear to be working, the permissions are the likely cause. If you need to update bot permissions, remove the bot and re-invite with the updated set. To avoid any headaches, you could simply select the "Administrator" permission and it should have access to everything.

Step 9: Now, this is totally optional, but if you would like your bot to run continuously without needing to boot it on your machine, you can opt to set it up on a virtual machine. Back on Google Cloud, go to Compute Engine and you can acquire a VM at an extremely cheap cost. Just select the cheapest option available, it will be sufficient. This video here shows the process I followed for creating the VM and installing my bot: https://youtu.be/VEn70C7S5Q8. Note that you will need to make sure that ALL packages imported by your bot script are installed on this VM in addition to the ones shown in the video. Also make sure to add your .env file to the VM if you chose to use one.

Step 10: All you need at this point is to set up your fileMonitor.py script and distribute it to your team! Most of the ommitted variables you can copy from lockoutBot.py, the other two each team member will need to set individually. In distributing the program, I chose to encode the auth keys directly in the script and package it into an executable using pyinstaller. This obscures the keys and allows each person to use the program without having to install all the python packages themselves. Each team member then creates their own .env file to store beside the script which includes the USER_NAME (their Discord display name) and USER_ID (copied using developer mode in Discord) variables. You will also need to ensure that the script has access to your Google service account JSON. You can do this by having the file stored beside the script as well.


After all that, you should be ready to make use of this system to avoid Blueprint conflicts! There's a lot of little details in this process - and I probably forgot to mention a few. If you have any questions or suggestions, feel free to reach out to me at tycobb582@gmail.com. One last suggestion I have for you is to have each team member set up an automation that will boot the file monitor script whenever they run your Unreal project. If you package the script as an executable, you should be able to accomplish this in Rider by creating an Executable run configuration that points to the .exe, and a Compound run configuration that launches your Executable config and the config that launches your project.

